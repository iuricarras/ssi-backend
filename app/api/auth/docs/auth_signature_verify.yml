tags:
  - Autenticação
summary: Verifica a assinatura digital e retorna JWTs
description: >
  Valida a assinatura do nonce usando a chave pública fornecida. Se a assinatura for válida, gera tokens JWT.
  
  NOTA: Em um ambiente de produção seguro, a 'public_key_pem' não deve ser enviada pelo cliente,
  mas recuperada do banco de dados do usuário (por 'email').

consumes:
  - application/json

parameters:
  - in: body
    name: body
    required: true
    schema:
      type: object
      properties:
        email:
          type: string
        challenge_id:
          type: string
        signature:
          type: string
          description: O Nonce assinado em formato Base64.
        public_key_pem:
          type: string
          description: A chave pública do usuário no formato PEM (APENAS PARA PROTÓTIPO).
      required:
        - email
        - challenge_id
        - signature
        - public_key_pem

responses:
  200:
    description: Assinatura validada.
    schema:
      type: object
      properties:
        ok:
          type: boolean
        access_token:
          type: string
        refresh_token:
          type: string

  400:
    description: Desafio inválido, expirado, usado ou assinatura inválida.